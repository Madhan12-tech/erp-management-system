<!-- workforce.html - PART 1: Basic Layout and Tabs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Workforce Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
.popup {
  display: none;
  position: fixed;
  z-index: 999;
  left: 0; top: 0;
  width: 100%; height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.6);
}

.popup-content {
  background-color: #fff;
  margin: 5% auto;
  padding: 30px;
  border: 2px solid #333;
  border-radius: 10px;
  width: 90%;
  max-width: 1000px;
  max-height: 90%;
  overflow-y: auto;
}

.table-container {
  overflow-x: auto;
  margin-top: 10px;
}

.popup-content table {
  width: 100%;
  border-collapse: collapse;
}

.popup-content th, .popup-content td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}

.popup-content th {
  background-color: #f2f2f2;
}

button.close {
  margin-top: 20px;
}

.popup-buttons {
  margin-bottom: 20px;
}

.popup-buttons button {
  margin: 5px;
  padding: 10px 15px;
  font-weight: bold;
}
</style>
</head>
<body>
    <div class="container py-4">
        <h2 class="mb-4">Workforce / HR Management</h2>

        <div class="d-flex flex-wrap gap-2 mb-3">
            <button class="btn btn-primary" onclick="openPopup('payrollPopup')">Payroll</button>
            <button class="btn btn-secondary" onclick="openPopup('attendancePopup')">Attendance</button>
            <button class="btn btn-success" onclick="openPopup('leavePopup')">Leave</button>
            <button class="btn btn-warning" onclick="openPopup('performancePopup')">Performance</button>
            <button class="btn btn-info" onclick="openPopup('trainingPopup')">Training</button>
            <button class="btn btn-dark" onclick="openPopup('documentsPopup')">Documents</button>
            <button class="btn btn-danger" onclick="openPopup('bonusDeductionPopup')">Bonus & Deductions</button>
        </div>

        <!-- JavaScript to handle popups -->
        <script>
            function openPopup(id) {
                document.getElementById(id).style.display = 'block';
            }
            function closePopup(id) {
                document.getElementById(id).style.display = 'none';
            }
        </script>
        <!-- Payroll Popup -->
<div id="payrollPopup" class="popup">
  <div class="popup-content">
    <h3>Payroll Management</h3>

    <form method="POST" action="/add_workforce">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="text" name="department" placeholder="Department" required>
      <input type="number" name="salary" placeholder="Salary" required>
      <input type="number" name="present_days" placeholder="Present Days" required>
      <input type="number" name="leave_days" placeholder="Leave Days" required>
      <input type="number" name="bonus" placeholder="Bonus" required>
      <input type="number" name="deductions" placeholder="Deductions" required>
      <input type="date" name="join_date" required>
      <input type="text" name="site_assigned" placeholder="Site Assigned">
      <button type="submit">Add Payroll Entry</button>
    </form>

    <hr>
    <input type="text" id="payrollFilter" onkeyup="filterTable('payrollTable', this.value)" placeholder="Search by name...">
    <button onclick="window.location.href='/export_workforce_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_workforce_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="payrollTable">
        <thead>
          <tr>
            <th>ID</th><th>Name</th><th>Dept</th><th>Salary</th><th>Present</th><th>Leave</th>
            <th>Bonus</th><th>Deduction</th><th>Total Pay</th><th>Join Date</th><th>Site</th>
          </tr>
        </thead>
        <tbody>
          {% for row in workforce %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>₹{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
            <td>{{ row[5] }}</td>
            <td>₹{{ row[6] }}</td>
            <td>₹{{ row[7] }}</td>
            <td><b>₹{{ row[8] }}</b></td>
            <td>{{ row[9] }}</td>
            <td>{{ row[10] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('payrollPopup')">Close</button>
  </div>
</div>
<!-- Attendance Popup -->
<div id="attendancePopup" class="popup">
  <div class="popup-content">
    <h3>Mark Attendance</h3>

    <form method="POST" action="/add_attendance">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="date" name="date" required>
      <select name="status" required>
        <option value="Present">Present</option>
        <option value="Absent">Absent</option>
        <option value="Leave">Leave</option>
      </select>
      <button type="submit">Submit</button>
    </form>

    <hr>
    <input type="text" id="attendanceFilter" onkeyup="filterTable('attendanceTable', this.value)" placeholder="Search attendance...">
    <button onclick="window.location.href='/export_attendance_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_attendance_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="attendanceTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Date</th><th>Status</th></tr>
        </thead>
        <tbody>
          {% for row in attendance %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('attendancePopup')">Close</button>
  </div>
</div>
<!-- Leave Popup -->
<div id="leavePopup" class="popup">
  <div class="popup-content">
    <h3>Leave Management</h3>

    <form method="POST" action="/add_leave">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="date" name="from_date" required>
      <input type="date" name="to_date" required>
      <input type="text" name="reason" placeholder="Reason" required>
      <button type="submit">Add Leave</button>
    </form>

    <hr>
    <input type="text" id="leaveFilter" onkeyup="filterTable('leaveTable', this.value)" placeholder="Search leaves...">
    <button onclick="window.location.href='/export_leave_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_leave_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="leaveTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>From</th><th>To</th><th>Reason</th></tr>
        </thead>
        <tbody>
          {% for row in leaves %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('leavePopup')">Close</button>
  </div>
</div>
<!-- Performance Popup -->
<div id="performancePopup" class="popup">
  <div class="popup-content">
    <h3>Performance Tracking</h3>

    <form method="POST" action="/add_performance">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="text" name="month" placeholder="Month (e.g., July)" required>
      <input type="number" name="score" placeholder="Performance Score" required>
      <input type="text" name="remarks" placeholder="Remarks">
      <button type="submit">Submit</button>
    </form>

    <hr>
    <input type="text" id="performanceFilter" onkeyup="filterTable('performanceTable', this.value)" placeholder="Search performance...">
    <button onclick="window.location.href='/export_performance_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_performance_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="performanceTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Month</th><th>Score</th><th>Remarks</th></tr>
        </thead>
        <tbody>
          {% for row in performance %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('performancePopup')">Close</button>
  </div>
</div>
<!-- Training Popup -->
<div id="trainingPopup" class="popup">
  <div class="popup-content">
    <h3>Training Records</h3>

    <form method="POST" action="/add_training">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="text" name="topic" placeholder="Training Topic" required>
      <input type="text" name="trainer" placeholder="Trainer Name" required>
      <input type="date" name="date" required>
      <button type="submit">Add Training</button>
    </form>

    <hr>
    <input type="text" id="trainingFilter" onkeyup="filterTable('trainingTable', this.value)" placeholder="Search training...">
    <button onclick="window.location.href='/export_training_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_training_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="trainingTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Topic</th><th>Trainer</th><th>Date</th></tr>
        </thead>
        <tbody>
          {% for row in training %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('trainingPopup')">Close</button>
  </div>
</div>
        <!-- Documents Popup -->
<div id="documentsPopup" class="popup">
  <div class="popup-content">
    <h3>Upload Employee Documents</h3>

    <form method="POST" action="/add_document">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="text" name="doc_type" placeholder="Document Type" required>
      <input type="date" name="uploaded_on" required>
      <button type="submit">Upload</button>
    </form>

    <hr>
    <input type="text" id="docFilter" onkeyup="filterTable('documentsTable', this.value)" placeholder="Search documents...">
    <button onclick="window.location.href='/export_documents_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_documents_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="documentsTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Document Type</th><th>Uploaded On</th></tr>
        </thead>
        <tbody>
          {% for row in documents %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('documentsPopup')">Close</button>
  </div>
</div>
        <!-- Department Assignment Popup -->
<div id="departmentPopup" class="popup">
  <div class="popup-content">
    <h3>Assign Department</h3>

    <form method="POST" action="/add_department">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="text" name="department" placeholder="Department Name" required>
      <button type="submit">Assign</button>
    </form>

    <hr>
    <input type="text" id="deptFilter" onkeyup="filterTable('departmentTable', this.value)" placeholder="Search departments...">
    <button onclick="window.location.href='/export_department_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_department_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="departmentTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Department</th></tr>
        </thead>
        <tbody>
          {% for row in departments %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('departmentPopup')">Close</button>
  </div>
</div>
        <!-- Bonus Popup -->
<div id="bonusPopup" class="popup">
  <div class="popup-content">
    <h3>Employee Bonus</h3>

    <form method="POST" action="/add_bonus">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="number" step="0.01" name="bonus" placeholder="Bonus Amount" required>
      <input type="date" name="date" required>
      <button type="submit">Add Bonus</button>
    </form>

    <hr>
    <input type="text" id="bonusFilter" onkeyup="filterTable('bonusTable', this.value)" placeholder="Search bonus records...">
    <button onclick="window.location.href='/export_bonus_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_bonus_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="bonusTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Bonus</th><th>Date</th></tr>
        </thead>
        <tbody>
          {% for row in bonus %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('bonusPopup')">Close</button>
  </div>
</div>
        <!-- Deduction Popup -->
<div id="deductionPopup" class="popup">
  <div class="popup-content">
    <h3>Employee Deductions</h3>

    <form method="POST" action="/add_deduction">
      <input type="text" name="name" placeholder="Employee Name" required>
      <input type="number" step="0.01" name="deduction" placeholder="Deduction Amount" required>
      <input type="text" name="reason" placeholder="Reason" required>
      <input type="date" name="date" required>
      <button type="submit">Add Deduction</button>
    </form>

    <hr>
    <input type="text" id="deductionFilter" onkeyup="filterTable('deductionTable', this.value)" placeholder="Search deductions...">
    <button onclick="window.location.href='/export_deduction_excel'">Export Excel</button>
    <button onclick="window.location.href='/export_deduction_pdf'">Export PDF</button>

    <div class="table-container">
      <table id="deductionTable">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Deduction</th><th>Reason</th><th>Date</th></tr>
        </thead>
        <tbody>
          {% for row in deductions %}
          <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <button class="close" onclick="closePopup('deductionPopup')">Close</button>
  </div>
</div>
        <div class="popup-buttons">
  <button onclick="openPopup('addEmployeePopup')">+ Add Employee</button>
  <button onclick="openPopup('attendancePopup')">Attendance</button>
  <button onclick="openPopup('leavePopup')">Leave</button>
  <button onclick="openPopup('performancePopup')">Performance</button>
  <button onclick="openPopup('trainingPopup')">Training</button>
  <button onclick="openPopup('documentsPopup')">Documents</button>
  <button onclick="openPopup('departmentPopup')">Departments</button>
  <button onclick="openPopup('bonusPopup')">Bonus</button>
  <button onclick="openPopup('deductionPopup')">Deductions</button>
        </div>
        <script>
  function openPopup(id) {
    document.getElementById(id).style.display = 'block';
  }

  function closePopup(id) {
    document.getElementById(id).style.display = 'none';
  }

  function filterTable(tableId, value) {
    let input = value.toLowerCase();
    let rows = document.querySelectorAll(`#${tableId} tbody tr`);
    rows.forEach(row => {
      row.style.display = [...row.cells].some(td => td.innerText.toLowerCase().includes(input)) ? '' : 'none';
    });
  }
        </script>
        
