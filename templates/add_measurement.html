<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Measurement</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }
    .form-section, .table-section {
      width: 48%;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    th {
      background: #007bff;
      color: #fff;
    }
    .btn {
      padding: 10px;
      margin-top: 10px;
      cursor: pointer;
    }
    .btn-export {
      margin-right: 10px;
    }
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #28a745;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      display: none;
      z-index: 1000;
    }
    .dark-mode {
      background: #2b2b2b;
      color: #fff;
    }
    .dark-mode table, .dark-mode th, .dark-mode td {
      border-color: #555;
    }
    .dark-mode th {
      background: #444;
    }
  </style>
</head>
<body>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="toast" id="toast">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<h2>Project Measurement Sheet</h2>

<div class="container">
  <!-- Left Form -->
  <div class="form-section">
    <h3>Add Duct Entry</h3>
    <form method="POST">
      <input type="text" name="duct_no" placeholder="Duct No" required>
      <input type="text" name="duct_type" placeholder="Duct Type" required>
      <input type="number" name="length" placeholder="Length" step="0.01" required>
      <input type="number" name="breadth" placeholder="Breadth" step="0.01" required>
      <input type="number" name="height" placeholder="Height" step="0.01" required>
      <input type="text" name="gauge" placeholder="Gauge" required>
      <input type="number" name="quantity" placeholder="Quantity" required>
      <button type="submit" class="btn">Save Measurement</button>
    </form>
  </div>

  <!-- Right Table -->
  <div class="table-section">
    <h3>Live Measurements</h3>

    <div style="margin-bottom: 10px;">
      <a href="/export_measurements/csv/{{ project_id }}" class="btn btn-export">Export CSV</a>
      <a href="/export_measurements/excel/{{ project_id }}" class="btn btn-export">Export Excel</a>
      <a href="/export_measurements/pdf/{{ project_id }}" class="btn btn-export">Export PDF</a>
      <button onclick="window.print()" class="btn">Print</button>
      <button onclick="toggleDarkMode()" class="btn">Toggle Dark Mode</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>Duct No</th>
          <th>Type</th>
          <th>Length</th>
          <th>Breadth</th>
          <th>Height</th>
          <th>Gauge</th>
          <th>Qty</th>
          <th>Area</th>
        </tr>
      </thead>
      <tbody>
        {% for m in measurements %}
        <tr>
          <td>{{ m[2] }}</td>
          <td>{{ m[3] }}</td>
          <td>{{ m[4] }}</td>
          <td>{{ m[5] }}</td>
          <td>{{ m[6] }}</td>
          <td>{{ m[7] }}</td>
          <td>{{ m[8] }}</td>
          <td>{{ m[9] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
  // Show toast for 3 seconds
  const toast = document.getElementById('toast');
  if (toast) {
    toast.style.display = 'block';
    setTimeout(() => {
      toast.style.display = 'none';
    }, 3000);
  }

  // Dark mode toggle
  function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
  }
</script>

</body>
</html>
